\documentclass[12pt,letterpaper,fleqn]{hmcpset}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{parskip}

\input{macros.tex}

% info for header block in upper right hand corner
\name{Justin Jiang}
\class{Math189R SU20}
\assignment{Homework 6}
\duedate{Monday, Jun 29, 2020}

\begin{document}

Feel free to work with other students, but make sure you write up the homework
and code on your own (no copying homework \textit{or} code; no pair programming).
Feel free to ask students or instructors for help debugging code or whatever else,
though.
\newline
\newline
The starter files for problem 2 can be found under the Resource tab on course website. Please print out all the graphs generated by your own code and submit them together with the written part, and make sure you upload the code to your Github repository.\\

\begin{problem}[1]
\textbf{(Murphy 11.2 - EM for Mixtures of Gaussians)} Show that the M step for ML
estimation of a mixture of Gaussians is given by
\begin{align*}
    \mub_k &= \frac{\sum_i r_{ik}\xx_i}{r_k}\\
    \Sigmab_k &= \frac{1}{r_k}\sum_i r_{ik}(\xx_i - \mub_k)(\xx_i - \mub_k)^\T = \frac{1}{r_k}\sum_i r_{ik}\xx_i\xx_i^\T - r_k\mub_k\mub_k^\T.
\end{align*}
\end{problem}
\begin{solution}
The data log likelihood is as follows: \[
l(\mu_k, \Sigma_k) = \sum_k \sum_i r_{ik} log \PP(\xx_i|\theta_k) \]
\[
= -0.5 \sum_i r_{ik} (log |\Sigma_k| + (\xx_i - \mu_k)^T \Sigma_k^{-1}(\xx_i - \mu_k))
\]
Next, take the partial with respect to $\mu_k: $ \[
\frac{\partial l}{\partial \mu_k} = \Sigma_k^{-1} \sum_i r_{ik} (\xx_i - \mu_k) = 0 
\]
\[ \sum_i r_{ik}\xx_i = \mu_k \sum_i r_{ik} \]
Had to look at solutions for this step: \\
Now, take the derivative with respect to $\Sigma_k$, we will get: \\
\[ \frac{\partial l}{\partial \Sigma_k} = -0.5 \sum_i r_ik (\Sigma_k^{-1} - \Sigma_k^{-1}(\xx_i - \mu_k)^T \Sigma_k^{-1}) = 0 \]
Then we can multiply by $\Sigma_k$ and divide by $r_k = \Sigma_i r_{ik} $ to get the desired result
\end{solution}
\newpage



\begin{problem}[2]
\textbf{(SVD Image Compression)}
In this problem, we will use the image of a scary clown online to perform image compression.  In the starter code, we have already load the image into a matrix/array for you. However, you might need internet connection to access the image and therefore successfully run the starter code. The code requires Python library Pillow in order to run.
\newline
\newline 
Plot the progression of the 100 largest singular values for the original image
and a randomly shuffled version of the same image (all on the same plot). In a single figure plot
a grid of four images: the original image, and a rank $k$ truncated SVD approximation of the original
image for $k\in\{2,10,20\}$.

\end{problem}
\begin{solution}
I've included my graph and pictures as part of the submission to github
\end{solution}
\newpage

\end{document}
