\documentclass[12pt,letterpaper,fleqn]{hmcpset}
\usepackage[margin=1in]{geometry}
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{enumerate}
\usepackage{hyperref}
\usepackage{parskip}

\input{macros.tex}

% info for header block in upper right hand corner
\name{}
\class{Math189R SP19}
\assignment{Homework 8}
\duedate{Thursday, Apr 15, 2019}

\begin{document}

Feel free to work with other students, but make sure you write up the homework
and code on your own (no copying homework \textit{or} code; no pair programming).
Feel free to ask students or instructors for help debugging code or whatever else,
though.
\newline
\newline
The starter files for problem 1 and extra credit can be found under the Resource tab on course website. Please print out all the graphs generated by your own code and submit them together with the written part, and make sure you upload the code to your Github repository.



\begin{problem}[1]
\textbf{(K-means)} In this problem, we will implement the k-means algorithm and separate 5,000 2D data points into different number of clusters.
\newline
\par Let $X = {x_1, x_2 \ldots, x_m} $ be the data points, and let $k$ be the number of clusters. The k-means algorithm is summarized as following:
\begin{enumerate}[1.]
\item Randomly initialize $k$ cluster centers, $\mu_1, \mu_2 \ldots \mu_k$, in the feature space.
\item Calculate the distance between each data points and the cluster centers.
\item Assign each data point to the cluster center $c$ whose distance between this data point is the minimum of all the cluster centers, namely, \[
c_i = \argmin_j ||x_i - \mu_j||^2
\]
\item Update each cluster center to be\[
\mu_j = \frac{\sum_{i=1}^{m}1\{c_i = j\}x_i}{\sum_{i = 1}^{m}1\{c_i = j\}}
\]
\item Repeat step 2 - 4 until convergence or exhausted.
\end{enumerate}
\par 
The objective (cost) function is defined as \[
J(c, \mu) = \sum_{i = 1}^{m}||x_i - \mu_{c_i}||^2
\]

\par In this assignment, you will first implement the k-means cost function and the algorithm. Then, for $k = 1, 2 \ldots, 20$, find the number of clusters with the optimal cost and produce a plot of the relationship between the cost and the number of clusters. Then, visualize the data points and the cluster centers on the optimal number of clusters.
\newline 
\par Notice that the k-means algorithm might yield different results based on the randomness of the initialization of cluster centers.
\end{problem}
\begin{solution}
I've included my submission with graphs on github.
\end{solution}
\newpage




\begin{problem}[Extra Credit]
\textbf{(Non-Negative Matrix Factorization)} 
In this problem, we will use the reuters dataset in nltk library. Please run nltk.download() in python shell to download the dataset. In the starter code, we have already parsed the data for you. 
\newline
\newline
Choosing an appropriate
objective function and algorithm from Lee and Seung 2001\footnote{\url{https://papers.nips.cc/paper/1861-algorithms-for-non-negative-matrix-factorization.pdf}}
implement Non-Negative Matrix Factorization for topic modelling (choose an appropriate number
of topics/latent features) and assert that the convergence properties proved in the paper hold. 
Display the 20 most relevant words for each of the topics you discover.
\end{problem}
\begin{solution}
I've attached the generated graph in the submission to github. However, I couldn't get the last line working, so I couldn't include the 20 most relevant words from the topics. 
\end{solution}



\end{document}
